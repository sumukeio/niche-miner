# 百度广告验证工具 - 可视化界面使用说明

## 📋 功能概述

在 NicheMiner 中集成了百度广告验证工具的可视化界面，提供友好的Web界面来验证关键词的广告投放情况。

## 🚀 访问入口

1. **从首页进入**：在 NicheMiner 首页右上角，点击"广告验证工具"按钮
2. **直接访问**：访问 `/ad-validator` 路径

## 🎯 主要功能

### 1. 文件上传

- 支持 Excel 文件（.xlsx, .xls, .csv）
- 文件必须包含 `Keyword` 列（关键词列）
- 点击上传区域选择文件

### 2. 验证模式

#### PC端验证
- 点击"模拟PC端抓取"按钮
- 使用PC端浏览器模拟访问
- 访问 `www.baidu.com`

#### 移动端验证
- 点击"模拟移动端抓取"按钮
- 使用移动端浏览器模拟访问
- 访问 `m.baidu.com`
- **重要**：很多广告只在移动端投放，建议同时验证PC端和移动端

### 3. 多IP轮换

- 自动使用5个代理IP轮换验证
- 每个IP完整验证所有关键词
- 最后合并所有结果并去重
- 配置方式：在 `.env.local` 文件中配置代理IP

### 4. 实时日志

- 显示验证过程的实时日志
- 包含进度信息、代理切换、错误提示等
- 自动滚动到底部
- 支持清空日志

### 5. 结果展示

- **PC端结果**和**移动端结果**分别展示
- 显示统计信息：
  - 总关键词数
  - 有广告的关键词数
- 展示去重后的广告URL列表
- 支持导出为CSV文件

## ⚙️ 配置代理IP

### 方法1：环境变量配置

在项目根目录创建 `.env.local` 文件：

```env
PROXY_1=http://proxy1.example.com:8080
PROXY_2=http://proxy2.example.com:8080
PROXY_3=http://proxy3.example.com:8080
PROXY_4=http://proxy4.example.com:8080
PROXY_5=http://proxy5.example.com:8080
```

### 支持的代理格式

- HTTP代理：`http://host:port`
- HTTPS代理：`https://host:port`
- SOCKS5代理：`socks5://host:port`
- 带认证：`http://username:password@host:port`

### 方法2：不配置代理

如果不配置代理IP，系统会使用直连方式运行5次（相当于轮换）。

## 📊 使用流程

1. **准备关键词文件**
   - 创建Excel文件，包含 `Keyword` 列
   - 每个关键词一行

2. **上传文件**
   - 点击上传区域
   - 选择关键词Excel文件

3. **选择验证模式**
   - 点击"模拟PC端抓取"或"模拟移动端抓取"
   - 可以分别运行，也可以都运行

4. **观察日志**
   - 实时查看验证进度
   - 查看代理切换信息
   - 查看错误提示（如果有）

5. **查看结果**
   - PC端和移动端结果分别展示
   - 查看统计信息和广告URL列表
   - 点击链接可直接访问广告页面

6. **导出结果**
   - 点击"导出CSV"按钮
   - 下载包含所有结果的CSV文件

## 🔍 结果说明

### 去重逻辑

- 使用"关键词 + 广告链接"作为唯一标识
- 5个IP轮换验证后，自动去重
- 最终展示的是去重后的结果

### 结果格式

每个关键词可能包含多个广告：
- 广告标题1、广告链接1
- 广告标题2、广告链接2
- 广告标题3、广告链接3

## ⚠️ 注意事项

1. **代理IP配置**：如果没有配置有效的代理IP，系统会使用直连方式
2. **运行时间**：验证时间取决于关键词数量和网络速度，可能需要较长时间
3. **资源占用**：运行时会启动浏览器进程，占用一定系统资源
4. **错误处理**：如果某个代理失败，会继续使用下一个代理
5. **结果保存**：临时结果文件保存在 `temp/` 目录下

## 🐛 故障排除

### 问题1：启动失败

**可能原因**：
- Python环境未配置
- `baidu_ad_validator.py` 文件不存在
- 缺少Python依赖包

**解决方案**：
- 确保已安装Python 3.x
- 确保 `baidu_ad_validator.py` 在项目根目录
- 运行 `pip install -r requirements.txt`

### 问题2：代理连接失败

**可能原因**：
- 代理IP配置错误
- 代理服务器不可用
- 网络连接问题

**解决方案**：
- 检查代理IP格式是否正确
- 测试代理是否可用
- 尝试不使用代理（直连）

### 问题3：结果为空

**可能原因**：
- 关键词确实没有广告
- 所有广告都被过滤（京东、天猫等平台广告）
- 验证过程中出现错误

**解决方案**：
- 检查日志查看是否有错误信息
- 尝试手动搜索关键词验证是否有广告
- 检查过滤规则是否过于严格

### 问题4：日志不更新

**可能原因**：
- SSE连接断开
- 后端进程异常
- 网络问题

**解决方案**：
- 刷新页面重新开始
- 检查浏览器控制台错误信息
- 查看后端日志

## 📝 技术说明

### 架构设计

- **前端**：Next.js React组件
- **后端**：Next.js API路由
- **Python脚本**：`baidu_ad_validator.py`
- **通信**：Server-Sent Events (SSE) 实时日志流

### 数据流程

```
用户上传文件
  ↓
API接收文件并保存
  ↓
启动Python脚本（5次，每次使用不同IP）
  ↓
Python脚本输出日志 → SSE流 → 前端显示
  ↓
Python脚本生成结果文件
  ↓
API读取并解析结果文件
  ↓
合并和去重
  ↓
通过SSE发送最终结果
  ↓
前端展示结果
```

---

**最后更新**: 2024-12-24







