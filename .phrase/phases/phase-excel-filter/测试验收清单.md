# Excel 智能筛选工具 - 测试验收清单

## 功能测试清单

### 阶段1：文件上传与解析 ✅

#### 1.1 文件上传功能
- [ ] 支持拖拽上传 Excel 文件
- [ ] 支持点击选择文件
- [ ] 文件类型验证（CSV、XLSX、XLS）
- [ ] 文件大小验证（最大50MB）
- [ ] 上传后显示文件信息
- [ ] 支持删除已选文件

#### 1.2 文件解析功能
- [ ] 正确解析 Excel 文件（.xlsx）
- [ ] 正确解析 Excel 文件（.xls）
- [ ] 正确解析 CSV 文件
- [ ] 处理空行和空列
- [ ] 处理特殊字符和中文

#### 1.3 字段识别功能
- [ ] 自动识别表头行（高置信度）
- [ ] 自动识别表头行（中置信度）
- [ ] 自动识别表头行（低置信度）
- [ ] 支持手动调整表头行号
- [ ] 显示识别置信度

### 阶段2：数据预览 ✅

#### 2.1 预览表格
- [ ] 显示每列前10条数据
- [ ] 支持横向滚动（多列）
- [ ] 空值显示为"（空）"
- [ ] 显示总行数统计
- [ ] 表格样式正确

#### 2.2 字段选择
- [ ] 显示所有字段列表
- [ ] 支持多选字段
- [ ] 显示已选择字段数量
- [ ] 空列处理正确

### 阶段3：筛选配置 ✅

#### 3.1 列选择
- [ ] 可以选择单个列
- [ ] 可以选择多个列
- [ ] 可以取消选择
- [ ] 显示已选择数量

#### 3.2 关键词输入
- [ ] 可以输入关键词
- [ ] 支持中文关键词
- [ ] 支持回车触发筛选
- [ ] 输入验证（不能为空）

#### 3.3 筛选规则选择
- [ ] 可以选择"包含"规则
- [ ] 可以选择"后缀"规则
- [ ] 可以选择"前缀"规则
- [ ] 规则说明清晰

### 阶段4：筛选执行 ✅

#### 4.1 筛选规则验证
- [ ] **包含规则**：
  - [ ] 输入"手串"，能筛选出包含"手串"的所有内容
  - [ ] 示例："沉香手串价格" → 提取"沉香手串价格"
  
- [ ] **后缀规则**：
  - [ ] 输入"手串"，能筛选出以"手串"结尾的内容
  - [ ] 示例："黄花梨手串价格" → 提取"黄花梨手串"
  - [ ] 示例："沉香手串" → 提取"沉香手串"
  
- [ ] **前缀规则**：
  - [ ] 输入"沉香"，能筛选出以"沉香"开头的内容
  - [ ] 示例："沉香手串价格" → 提取"沉香手串价格"

#### 4.2 去重功能
- [ ] 相同关键词只保留一个
- [ ] 去重统计准确
- [ ] 大小写不敏感去重

#### 4.3 性能测试
- [ ] 处理 1,000 行数据 < 1 秒
- [ ] 处理 5,000 行数据 < 3 秒
- [ ] 处理 10,000 行数据 < 5 秒
- [ ] 大文件显示进度条
- [ ] 处理过程中 UI 不卡顿

### 阶段5：结果展示 ✅

#### 5.1 统计信息
- [ ] 显示原始数据行数
- [ ] 显示筛选后数量
- [ ] 显示去重后数量
- [ ] 数字格式化（千分位）

#### 5.2 结果列表
- [ ] 显示所有筛选结果
- [ ] 显示关键词、来源列、来源行号
- [ ] 支持搜索关键词
- [ ] 支持复制关键词
- [ ] 表格样式正确

#### 5.3 导出功能
- [ ] 导出 CSV 格式正确
- [ ] 导出 Excel 格式正确
- [ ] CSV 文件支持中文（UTF-8 BOM）
- [ ] Excel 文件列宽自动调整
- [ ] 文件名包含日期

### 阶段6：手动筛选页面 ✅

#### 6.1 页面加载
- [ ] 通过 taskId 加载数据
- [ ] 显示任务信息
- [ ] 显示关键词列表
- [ ] 加载状态正确

#### 6.2 验证标记
- [ ] 单个标记为"已验证"
- [ ] 单个取消验证
- [ ] 批量标记为"已验证"
- [ ] 批量取消验证
- [ ] 标记后状态立即更新
- [ ] 统计信息实时更新

#### 6.3 筛选显示
- [ ] 显示全部关键词
- [ ] 仅显示已验证
- [ ] 仅显示未验证
- [ ] 切换筛选状态实时更新

#### 6.4 搜索与排序
- [ ] 搜索关键词功能正常
- [ ] 按字母顺序排序
- [ ] 按创建时间排序
- [ ] 按验证时间排序
- [ ] 搜索和排序组合使用

#### 6.5 导出功能
- [ ] 导出已验证关键词为 CSV
- [ ] 导出已验证关键词为 Excel
- [ ] 包含验证时间字段

### 阶段7：API 路由 ✅

#### 7.1 文件上传 API
- [ ] POST /api/excel-filter/upload 正常
- [ ] 返回解析结果
- [ ] 错误处理正确

#### 7.2 筛选处理 API
- [ ] POST /api/excel-filter/filter 正常
- [ ] 保存任务到数据库
- [ ] 保存结果到数据库
- [ ] 未登录用户也能使用（不保存）

#### 7.3 任务查询 API
- [ ] GET /api/excel-filter/tasks/:id 正常
- [ ] GET /api/excel-filter/tasks/:id/results 正常
- [ ] 支持分页
- [ ] 支持按验证状态筛选

#### 7.4 验证标记 API
- [ ] POST /api/excel-filter/results/:id/verify 正常
- [ ] POST /api/excel-filter/results/batch-verify 正常
- [ ] 权限验证正确

### 阶段8：用户体验 ✅

#### 8.1 错误处理
- [ ] 文件格式错误提示清晰
- [ ] 文件过大提示清晰
- [ ] 解析失败提示清晰
- [ ] 筛选失败提示清晰
- [ ] 网络错误提示清晰
- [ ] 所有错误都有重试选项

#### 8.2 加载状态
- [ ] 文件上传显示加载
- [ ] 文件解析显示加载
- [ ] 筛选执行显示进度
- [ ] 数据加载显示加载
- [ ] 操作执行显示加载

#### 8.3 操作反馈
- [ ] 操作成功有反馈
- [ ] 操作失败有提示
- [ ] 复制成功有提示
- [ ] 导出成功有提示

#### 8.4 响应式设计
- [ ] 移动端显示正常
- [ ] 平板端显示正常
- [ ] 桌面端显示正常
- [ ] 表格横向滚动正常

## 性能测试结果

### 测试环境
- 浏览器：Chrome / Firefox / Safari
- 设备：桌面 / 移动设备
- 文件大小：小（<1MB）/ 中（1-10MB）/ 大（>10MB）

### 测试数据
| 数据量 | 预期时间 | 实际时间 | 状态 |
|--------|----------|----------|------|
| 1,000 行 | < 1 秒 | ___ | ⬜ |
| 5,000 行 | < 3 秒 | ___ | ⬜ |
| 10,000 行 | < 5 秒 | ___ | ⬜ |
| 50,000 行 | < 30 秒 | ___ | ⬜ |

## 浏览器兼容性测试

- [ ] Chrome（最新版）
- [ ] Firefox（最新版）
- [ ] Safari（最新版）
- [ ] Edge（最新版）
- [ ] 移动端浏览器

## 已知问题

1. 无

## 测试完成日期

- 开始日期：_______
- 完成日期：_______
- 测试人员：_______

## 验收标准

✅ **所有核心功能正常工作**
✅ **性能满足要求（10,000行 < 5秒）**
✅ **用户体验流畅，错误提示清晰**
✅ **浏览器兼容性良好**

---

**测试状态**: ⬜ 未开始 | ⬜ 进行中 | ⬜ 已完成  
**验收状态**: ⬜ 未验收 | ⬜ 已验收

