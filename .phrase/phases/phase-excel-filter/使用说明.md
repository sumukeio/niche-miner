# Excel 智能筛选工具 - 使用说明

## 快速开始

### 1. 访问工具
访问 `/tools/excel-filter` 页面

### 2. 上传文件
- 拖拽 Excel 文件到上传区域，或点击"选择文件"
- 支持格式：CSV、XLSX、XLS
- 最大文件大小：50MB

### 3. 预览数据
- 系统自动识别表头行
- 查看每列前10条数据预览
- 如识别不准确，可手动调整表头行号
- 选择要处理的列（可多选）

### 4. 配置筛选
- 输入关键词（如"手串"）
- 选择筛选规则：
  - **包含**：提取包含关键词的整个单元格内容
  - **后缀**：提取以关键词结尾的片段（如"黄花梨手串价格" + "手串" → "黄花梨手串"）
  - **前缀**：提取以关键词开头的内容
- 点击"开始筛选"

### 5. 查看结果
- 查看筛选结果和统计信息
- 搜索关键词
- 复制关键词
- 导出为 CSV 或 Excel
- 导入到手动筛选页面进行验证

### 6. 手动筛选（可选）
- 点击"导入到手动筛选"
- 标记关键词为"已验证"
- 筛选显示已验证/未验证的关键词
- 导出已验证的关键词

## 筛选规则详解

### 规则1：包含该关键词
**用途**：提取包含关键词的所有内容

**示例**：
- 关键词："手串"
- 输入："沉香手串价格"
- 结果："沉香手串价格"（整个内容）

### 规则2：以该关键词为后缀
**用途**：提取以关键词结尾的片段

**示例**：
- 关键词："手串"
- 输入："黄花梨手串价格"
- 结果："黄花梨手串"（提取到关键词结束）

- 关键词："手串"
- 输入："沉香手串"
- 结果："沉香手串"（整个内容）

### 规则3：以该关键词为前缀
**用途**：提取以关键词开头的内容

**示例**：
- 关键词："沉香"
- 输入："沉香手串价格"
- 结果："沉香手串价格"（整个内容）

## 常见问题

### Q: 表头识别不准确怎么办？
A: 在预览数据步骤，点击"手动调整"，输入正确的表头行号（从1开始）。

### Q: 筛选结果为空？
A: 检查以下几点：
1. 关键词是否正确
2. 筛选规则是否合适
3. 选择的列是否包含该关键词
4. 数据格式是否正确

### Q: 大文件处理很慢？
A: 系统会自动分块处理大文件，并显示进度。如果超过10,000行，建议：
1. 等待处理完成（通常 < 5秒）
2. 或先筛选部分数据测试

### Q: 如何导出数据？
A: 在结果页面，点击"导出 CSV"或"导出 Excel"按钮。Excel 格式支持更好的格式化和列宽调整。

### Q: 未登录可以使用吗？
A: 可以。未登录用户可以正常使用所有功能，但筛选结果不会保存到数据库。登录后可以保存任务，方便后续查看和管理。

## 最佳实践

1. **文件准备**：
   - 确保 Excel 文件格式正确
   - 表头行清晰明确
   - 数据列不包含合并单元格

2. **关键词选择**：
   - 使用精确的关键词
   - 根据需求选择合适的规则
   - 后缀规则适合提取特定结尾的词

3. **列选择**：
   - 只选择包含关键词的列
   - 避免选择无关列，提高处理速度

4. **验证流程**：
   - 筛选后导入到手动筛选页面
   - 逐个或批量标记已验证的关键词
   - 导出已验证的关键词用于后续使用

## 技术支持

如遇到问题，请检查：
1. 浏览器控制台是否有错误
2. 网络连接是否正常
3. 文件格式是否正确

---

**版本**: 1.0  
**更新日期**: 2025-01-03

